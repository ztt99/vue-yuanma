{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/observe/array.js","../../src/observe/dep.js","../../src/observe/index.js","../../src/utils/next-tick.js","../../src/observe/schedular.js","../../src/observe/watcher.js","../../src/state.js","../../src/compile/parse-html.js","../../src/compile/index.js","../../src/vdom/patch.js","../../src/lifecycle.js","../../src/init.js","../../src/vdom/create-element.js","../../src/render.js","../../src/initGlobalAPI/extent.js","../../src/initGlobalAPI/index.js","../../src/index.js"],"sourcesContent":["export function isObject(data){\r\n    return typeof data === 'object' && data !== null\r\n}\r\n\r\nexport function proxy(vm,source,key){\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n            return vm[source][key]\r\n        },\r\n        set(val){\r\n            vm[source][key] = val\r\n        }\r\n    })\r\n}\r\nconst API_HOOkS = [\r\n    'beforeCreate',\r\n    'created',\r\n    'beforeMount',\r\n    'mounted',\r\n    'beforeUpdate',\r\n    'updated'\r\n]\r\nlet starts = {}\r\n\r\nstarts.components = function(parent,child){\r\n    const res = Object.create(parent)  //res.__proto__ = Object.create(parent)\r\n    for(let key in child){\r\n        res[key] = child[key]\r\n    }\r\n    return res\r\n}\r\n\r\n// starts.data = function(parent,child){\r\n//     return child\r\n// }\r\nAPI_HOOkS.forEach(hook=>{\r\n    starts[hook] = mergeHook\r\n})\r\nfunction mergeHook(parent,child){\r\n    if(child){\r\n        if(parent){\r\n            return parent.concat(child)\r\n        }else{\r\n            return [child]\r\n        }\r\n    }else{\r\n        return parent\r\n    }\r\n}\r\nexport  function mergeOptions(parent,child){\r\n    let options = {}\r\n    for(let key in parent){\r\n        mergefile(key)\r\n    } \r\n    for(let key in child){\r\n        if(!parent.hasOwnProperty(key)){\r\n            mergefile(key)\r\n        }\r\n    }\r\n    function mergefile(key){\r\n        if(starts[key]){\r\n            options[key]  = starts[key](parent[key],child[key])\r\n             return options[key]\r\n\r\n        }\r\n        if(typeof parent[key] == 'object' && typeof child[key] === 'object'){\r\n            options[key] = {...parent[key],...child[key]} //如果是引用类型，则合并\r\n        }else if(!child[key]){ //如果子类型没有则用父类型\r\n            options[key] = parent[key]\r\n        }else{\r\n            options[key] = child[key] \r\n        }\r\n    }\r\n\r\n    return options\r\n}\r\n\r\nexport const isReservedTag = makeMap(\r\n    'a,div,ul,li,span,p'\r\n)\r\n\r\n\r\nfunction makeMap(str){\r\n    let mapping = {}\r\n    let list = str.split(',')\r\n    list.forEach(item=>{\r\n        mapping[item] = true\r\n    })\r\n\r\n    return function(tag){\r\n        return mapping[tag]\r\n    }\r\n}","let  oldArrayMethods = Array.prototype\r\n\r\nexport const arrayMethods = Object.create(oldArrayMethods)\r\n\r\n//列举出会使数据变化的方法\r\nconst methods = ['push','pop','shift','unshift','splice','reverce','sort']\r\n\r\nmethods.forEach(name=>{\r\n    arrayMethods[name] = function(...args){\r\n       const result =  oldArrayMethods[name].apply(this,args)\r\n\r\n       let inserted,ob = this.__ob__\r\n       switch (name) {\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args\r\n               break; \r\n            case 'splice':\r\n                inserted = args.slice(2)\r\n       }\r\n       console.log('push',this);\r\n       ob.dep.notify() //数组push的时候不会触发get那里的notify\r\n       ob.observeArray(inserted)\r\n       return result\r\n    }\r\n})\r\n\r\n\r\n\r\n","let id = 0\r\nclass Dep{\r\n    constructor(){\r\n        this.id = id++\r\n        this.subs = []\r\n    }\r\n    addSub(watcher){\r\n        // 因为在addDep是去重了，所以这里不会重复添加watcher ，有几个需要观测的就有几个watcher\r\n        this.subs.push(watcher)\r\n    }\r\n    depend(){\r\n        // 让watcher记住当前的dep\r\n        // this.subs.push(Dep.target)\r\n        // 保存在watcher实例上一个dep\r\n        Dep.target.addDep(this) \r\n\r\n    }\r\n    notify(){\r\n        // 阶段一：只是有数据的更改，没有computed等，此时每个sub中只有一个watcher\r\n        this.subs.forEach(watcher=>{\r\n            watcher.update(); //修改完数据，触发updated\r\n            if(watcher.isWatcher){\r\n                watcher.cb()   //触发updated 生命周期\r\n            }\r\n        })\r\n    }\r\n}\r\nconst stack = []\r\n// 在初始化时 new Watcher的时候调用，然后执行getters函数，触发get函数\r\nexport function pushTarget(watcher){\r\n    Dep.target = watcher\r\n    stack.push(watcher)\r\n}\r\n\r\nexport function popTarget(){\r\n    stack.pop()\r\n    Dep.target = stack[stack.length - 1]\r\n}\r\n\r\nexport default Dep\r\n","import {isObject} from '../utils/index.js'\r\nimport { arrayMethods} from './array.js'\r\nimport Dep from './dep.js'\r\n//Object.defineProperty  不能兼容ie8 及以下 vue2 无法兼容ie8版本\r\n\r\nclass Observe{\r\n    constructor(data){\r\n        this.dep = new Dep\r\nconsole.log(data);\r\n        Object.defineProperty(data,'__ob__',{\r\n            enumerable:false,\r\n            configurable:false,\r\n            value :this\r\n        })\r\n        if(Array.isArray(data)){\r\n            data.__proto__ = arrayMethods\r\n            this.observeArray(data)\r\n        }else{\r\n            this.walk(data)  //监听对象\r\n        }\r\n    }\r\n    walk(data){\r\n        let keys = Object.keys(data)\r\n        for(let i = 0 , len = keys.length; i< len; i++){\r\n            let key = keys[i]\r\n            let value = data[key]\r\n            console.log(data,key,value);\r\n            defineReactive(data,key,value)\r\n        }\r\n    }\r\n    observeArray(data){\r\n        for(let i = 0, len = data.length;i<len;i++){\r\n            observe(data[i])\r\n        }\r\n    }\r\n}\r\n\r\n//defineReactive只监听对象\r\nfunction defineReactive(data,key,value){\r\n    let dep = new Dep()\r\n    //[1,2,3] [1,2,3] [1,2,3]\r\n    let childOb = observe(value)\r\n\r\n    Object.defineProperty(data,key,{\r\n        configurable:true,\r\n        enumerable:true,\r\n        get(){\r\n            if(Dep.target){\r\n                //已经触发 pushTarget 并且Dep.target = Watcher的实例\r\n                dep.depend()  //存watcher  如果是对象或者是数组会depend两次，  childOb.dep.depend()   dep.depend()\r\n                if(childOb){ //数组的依赖收集  这样this中就会得到收集watcher的notify\r\n                    childOb.dep.depend() \r\n                    // 如果数组中还有数组 \r\n                    if(Array.isArray(value)){\r\n                        dependArray(value)\r\n                    }\r\n                }\r\n            }\r\n            return value\r\n        },\r\n        set(newValue){\r\n            if(newValue === value) return \r\n            observe(newValue)  //用户设置的值可能是一个对象\r\n            value = newValue\r\n            dep.notify() //更新watcher 如果是数组push等不会触发set方法  notify只是为了更新dom\r\n        }\r\n    })\r\n}\r\n\r\n// 数组中的数组的依赖收集\r\nfunction dependArray(val){\r\n    for(let i = 0 ; i < val.length ; i++){\r\n        let current = val[i]\r\n        current.__ob__&&current.__ob__.dep.depend()\r\n        if(Array.isArray(current)){\r\n            dependArray(current)\r\n        }  \r\n    }\r\n}\r\nexport function observe(data){\r\n    if(!isObject(data)) return \r\n    return new Observe(data)\r\n}\r\n","\r\nlet callbacks = []\r\nlet waiting = false\r\n\r\nfunction flushCallback(){\r\n    while(callbacks.length){\r\n        let cb = callbacks.pop()\r\n        cb()\r\n    }\r\n    waiting = false\r\n\r\n}\r\nlet timerFunc;\r\n\r\nif(Promise){\r\n    timerFunc = ()=>{\r\n        Promise.resolve().then(flushCallback)\r\n    }\r\n}else if(MutationObserver){\r\n    // 监听dom变化 ，如果dom变化执行flushCallback\r\n    let observe = new MutationObserver(flushCallback)\r\n    let textNode = document.createTextNode(1)\r\n    observe.observe(textNode,{characterData:true})\r\n    timerFunc = ()=>{\r\n        textNode.textContent = 2\r\n    }\r\n}else if(setImmediate){\r\n    timerFunc = ()=>{\r\n        setImmediate(flushCallback)\r\n    }\r\n}else{\r\n    setTimeout(flushCallback)\r\n}\r\nexport function nextTick(cb){\r\n    // 只要没有添加完就继续添加\r\n    callbacks.push(cb)\r\n    if(!waiting){\r\n        waiting = true\r\n        // 已经放到宏任务中了，等到callbacks  push完毕后才会执行cb\r\n        // setTimeout会最后执行 这样最后只有一个setTimeout \r\n        timerFunc()\r\n    }\r\n    \r\n}","//调度的功能\r\n\r\nimport {nextTick } from '../utils/next-tick'\r\nlet queue = []\r\nlet has = { }\r\n\r\nfunction flushSchedularQueue(){\r\n    queue.forEach(watcher=>watcher.run()) \r\n    queue = []\r\n    has = { }\r\n}\r\n/**\r\n * 假设存在属性name，如果多次给name赋值，就会多次触发set，就会多次触发notify 就会触发watcher的update 就会触发geteers\r\n * 就会渲染dom，也就是说修改了相同的属性，但是还是多次触发没有意义\r\n */\r\nexport function queueWatcher(watcher){\r\n    let id = watcher.id  //现在只new 了一个watcher 所以id都是0\r\n    if(has[id]== null){\r\n        has[id] = true\r\n        queue.push(watcher)\r\n        // vue.nextTick = promise / mutationObserver / setImmediate / setTimeout  优雅降级\r\n        // 将更新dom放到宏任务中，同步代码执行完毕，再执行宏任务\r\n        nextTick(flushSchedularQueue)\r\n    }\r\n     \r\n}","import { pushTarget, popTarget } from './dep'\r\nimport { queueWatcher } from './schedular.js'\r\nlet id = 0\r\nclass Watcher {\r\n    constructor(vm, exportFn, cb, options = {}) {\r\n        this.vm = vm\r\n        this.cb = cb\r\n        this.options = options\r\n        this.isWatcher = typeof options === 'object' ? false : options //是渲染watcher\r\n        this.id = id++\r\n        this.lazy = options.lazy\r\n        this.dirty = options.lazy\r\n        this.user = options.user  //用户 watch\r\n        this.depsid = new Set()\r\n        this.deps = []\r\n        if (typeof exportFn == 'function') {\r\n            this.getter = exportFn\r\n        } else {\r\n            // getter 返回当前值\r\n            this.getter = function () {\r\n                let val = exportFn.split('.')\r\n                return val.reduce((p, c) => {\r\n                    return p[c]\r\n                }, vm)\r\n            }\r\n\r\n        }\r\n        // 默认先调用一次get  取值将结果保留下来\r\n        if (!this.lazy) {\r\n            this.value = this.get()\r\n        }\r\n    }\r\n    addDep(dep) {\r\n        // watcher里不能放重复的dep dep中不能放重复的watcher\r\n        // 进行去重操作，可能重复触发get \r\n        let id = dep.id\r\n        if (!this.depsid.has(id)) {\r\n            this.depsid.add(id)\r\n            this.deps.push(dep)\r\n            dep.addSub(this)\r\n        }\r\n    }\r\n    get() {\r\n        pushTarget(this) //添加watcher\r\n        let redult = this.getter.call(this.vm) //渲染watcher执行,调用render\r\n        popTarget()\r\n        return redult\r\n    }\r\n    update() {\r\n        if (this.lazy) {\r\n            this.dirty = true\r\n        } else {\r\n            // 每次get都会调用watcher中的get\r\n            // this.get()\r\n            queueWatcher(this)\r\n        }\r\n\r\n    }\r\n    run() {\r\n        this.newValue = this.get()\r\n        this.oldValue = this.value\r\n        if (this.user) {\r\n            this.cb.call(this.vm, this.newValue, this.oldValue)\r\n        }\r\n    }\r\n    evaluate() {\r\n        this.value = this.get()\r\n        this.dirty = false\r\n    }\r\n    depend(){\r\n        let i = this.deps.length\r\n        while(i--){\r\n            this.deps[i].depend()  //继续收集watcher \r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport default Watcher","import {observe}  from './observe/index'\r\nimport {proxy} from './utils/index.js'\r\nimport Watcher from './observe/watcher.js'\r\nimport Dep from './observe/dep'\r\nexport function initState(vm){\r\n    const opts = vm.$options\r\n    if(opts.props){\r\n        initProps(vm)\r\n    }\r\n    if(opts.data){\r\n        initData(vm)\r\n    }\r\n    if(opts.computed){\r\n        // 原理也是get ，会缓存，内部有变量 dirty\r\n        // 也是一个watcher\r\n        initComputed(vm)\r\n    }\r\n    if(opts.methods){\r\n        initMethods(vm)\r\n    }\r\n    if(opts.watch){\r\n        initWatch(vm)\r\n    }\r\n}\r\n\r\nfunction initProps(vm){}\r\n\r\nfunction initData(vm){\r\n    let data = vm.$options.data\r\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data\r\n\r\n    for(let key in data){\r\n        proxy(vm,'_data',key)\r\n    }\r\n    observe(data)\r\n}\r\nfunction initComputed(vm){\r\n    let computed = vm.$options.computed\r\n    const watchers = vm._computedWatchers = {}\r\n\r\n    // 1. 需要有watcher\r\n    // 2. 需要通过defineProperty\r\n    // 3. 需要一个变量\r\n    for(let key in computed){\r\n        const userDep = computed[key]\r\n        const getter = typeof userDep === 'function'? userDep:userDep.get\r\n        watchers[key] = new Watcher(vm,getter,()=>{},{lazy:true})\r\n        defineCpmputed(vm,key,userDep)\r\n    }\r\n\r\n}\r\n\r\nconst sharedPropertyDefinition = {\r\n    enumerable:true,\r\n    configurable:true,\r\n    get:()=>{},\r\n    set:()=>{}\r\n}\r\nfunction defineCpmputed(target,key ,userDep){\r\n    if(typeof userDep === 'function'){\r\n        // 需要重写get ， 进行缓存\r\n        sharedPropertyDefinition.get = createComputedGetter(key)\r\n    }else{\r\n        sharedPropertyDefinition.get =createComputedGetter(key) \r\n        sharedPropertyDefinition.set = userDep.set\r\n    }\r\n    Object.defineProperty(target,key,sharedPropertyDefinition)\r\n}\r\nfunction createComputedGetter(key){\r\n    return function(){\r\n         //如果是脏的就执行\r\n        const watcher = this._computedWatchers[key]\r\n        if(watcher){\r\n            if(watcher.dirty){ //如果是脏的就求值\r\n               watcher.evaluate()\r\n            }\r\n            if(Dep.target){ \r\n                /**\r\n                 * watcher则个watcher是计算属性的watcher ，如果存在其他watcher那么久收集起来\r\n                 */\r\n                watcher.depend()\r\n            }\r\n            return watcher.value\r\n        }\r\n        \r\n    }\r\n}\r\n\r\nfunction initMethods(vm){\r\n    let methods = vm.$options.methods\r\n    Object.keys(methods).forEach(method=>method.bind(vm))\r\n}\r\nfunction initWatch(vm){\r\n    let watch =  vm.$options.watch\r\n    for(let key in watch){\r\n        let handlers = watch[key]\r\n        if(Array.isArray(handlers)){\r\n            handlers.forEach(handler=>{ ///watch 的值是数组\r\n                createWatcher(vm,key,handler)\r\n            })\r\n        }else{\r\n            createWatcher(vm,key,handlers) //watch 的值是函数，字符串，对象\r\n        }\r\n    }\r\n}\r\n\r\nfunction createWatcher(vm,exprOrFn,handler,options){\r\n    if(typeof handler == 'object'){\r\n        options = handler\r\n        handler = handler.handler\r\n    }\r\n    if(typeof handler == 'string'){ //使用的是methods上的方法\r\n        handler = vm[handler]\r\n    }\r\n    /**\r\n     * exprOrFn 监听的属性\r\n     * handler 监听的方法\r\n     * options 监听的配置\r\n     * \r\n     */\r\n    return vm.$watch(exprOrFn,handler,options)\r\n}\r\n\r\nexport function stateMixin(Vue){\r\n    Vue.prototype.$watch = function (exprOrFn,cb,options={}){\r\n        new Watcher(this,exprOrFn,cb,{...options,user:true})\r\n        if(options.immediate){\r\n            cb()\r\n        }\r\n    }\r\n}\r\n","\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\r\nconst dynamicArgAttribute = /^\\s*((?:v-[\\w-]+:|@|:|#)\\[[^=]+\\][^\\s\"'<>\\/=]*)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`)\r\nconst startTagClose = /^\\s*(\\/?)>/\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\r\n\r\nlet currentParen\r\nlet root\r\nlet stack = []\r\nconst ELEMENT_TYPE = 1\r\nconst TEXT_TYPE = 3\r\n\r\nfunction createAstElement(tagName,attrs){\r\n    return {\r\n        tag:tagName,\r\n        type:ELEMENT_TYPE,\r\n        parent:null,\r\n        children:[],\r\n        attrs\r\n    }\r\n}\r\n\r\nfunction start(tagName,attrs){\r\n   let ele =  createAstElement(tagName,attrs)\r\n   if(!root) {\r\n    root = ele\r\n   }\r\n   currentParen = ele\r\n   stack.push(ele)\r\n}\r\nfunction chars(text){\r\n    text =  text.replace(/\\s/g,'')\r\n    if(text){\r\n        currentParen.children.push({\r\n            text,\r\n            type:TEXT_TYPE\r\n        })\r\n    }\r\n}\r\n\r\nfunction end(tagName){\r\n let ele =  stack.pop()\r\n currentParen  = stack[stack.length - 1]\r\n\r\n if(currentParen){\r\n    ele.parent = currentParen\r\n    currentParen.children.push(ele)\r\n }\r\n\r\n}\r\nexport  function paeseHTML(html) {\r\n     root = null\r\n    while (html) {\r\n        const textEnd = html.indexOf('<')\r\n        if (textEnd === 0) {  //如果等于0那么是开始标签\r\n            const startTagMatch = parseStartTag()\r\n            if (startTagMatch) {\r\n                start(startTagMatch.tagName,startTagMatch.attrs)\r\n                continue\r\n            }\r\n            let endTagMatch = html.match(endTag)\r\n            if (endTagMatch) {\r\n                advance(endTagMatch[0].length)\r\n                end(endTagMatch[1])\r\n                continue\r\n            }\r\n        }\r\n        let text\r\n        if (textEnd >= 0) {\r\n            text = html.substring(0, textEnd)\r\n        }\r\n        if (text) {\r\n            chars(text)\r\n            advance(text.length)\r\n        }\r\n\r\n        \r\n\r\n    }\r\n    return root\r\n\r\n\r\n    function advance(n) {\r\n        html = html.substring(n)\r\n    }\r\n\r\n    function parseStartTag() {\r\n        let start = html.match(startTagOpen)\r\n        const parse = {\r\n            tagName: start && start[1],\r\n            attrs: []\r\n        }\r\n        advance(start && start[0].length)  //删除已经放到parse中的字符串\r\n        let attrs, end;\r\n        while ((attrs = html.match(attribute)) && !(end = html.match(startTagClose))) { //如果有属性，并且不是结束标签\r\n            let obj = {\r\n                name: attrs[1],\r\n                value : attrs[3]\r\n            }\r\n            parse.attrs.push(obj)\r\n            advance(attrs[0].length)\r\n        }\r\n        if (end = html.match(startTagClose)) {\r\n            advance(end[0].length)\r\n            return parse\r\n        }\r\n        return null\r\n\r\n    }\r\n}","\r\nimport { paeseHTML } from './parse-html.js'\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\nexport function compileToFunctoin(template) {\r\n    let root = paeseHTML(template)\r\n    //将AST语法树生成render函数\r\n    // <div id='app'><p>hello {{name}}</p>hello</div>\r\n    //_c('div',{id:\"app\"},_c('p',undefined,_v(\"hello\" + _s(name)),_v('hello')))\r\n    return function render() {\r\n        let code =  generate(root)\r\n        let renderFn = new Function(`with(this){ return ${code}}`)\r\n        return renderFn\r\n    }\r\n}\r\n\r\nfunction generate(el) {\r\n    let code = `_c('${el.tag}',\r\n     ${el.attrs.length ? geneProps(el.attrs) : 'undefined'},\r\n     ${genChildren(el) ? genChildren(el) : ''})\r\n     `\r\n\r\n    return code\r\n}\r\nfunction genChildren(el) {\r\n\r\n    let children = el.children\r\n    if (children && children.length) {\r\n        return children.map(c => gen(c)).join(',')\r\n        // for(let i = 0 ; i < children.length;i++){\r\n        //     children[i].type == 1 ? text += generate(children[i])+',' : text += `_v(${children[i].text})`+ ','\r\n        // }\r\n    } else {\r\n        return false\r\n    }\r\n}\r\nfunction gen(node) {\r\n    if (node.type == 1) {\r\n        return generate(node)\r\n    } else {\r\n        let text = node.text\r\n        let tokens = []\r\n        let match, index;\r\n        let lastIndex = defaultTagRE.lastIndex = 0\r\n        while (match = defaultTagRE.exec(text)) {\r\n            index = match.index\r\n            if(lastIndex < index){\r\n                tokens.push(JSON.stringify( text.slice(lastIndex,index)))\r\n            }\r\n            // asas{{as}}asas{{as}}\r\n            tokens.push(`_s(${match[1]})`)\r\n            lastIndex = index +match[0].length\r\n        }\r\n        if(lastIndex < text.length){\r\n            tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n        }\r\n\r\n        return `_v(${tokens.join('+')})`\r\n    }\r\n}\r\nfunction geneProps(attrs) {\r\n    let str = ''\r\n    attrs.forEach(item => {\r\n        if (item.name === 'style') {\r\n            let obj = {}\r\n            const [key, value] = item.value.split(':')\r\n            obj[key] = value\r\n            item.value = obj\r\n        }\r\n        str += `${item.name}:${JSON.stringify(item.value)},`\r\n    })\r\n    return `{${str.slice(0, -1)}}`\r\n}\r\n\r\n\r\n\r\n\r\n","export function patch(oldVnode, vnode) {\r\n    if(!oldVnode){\r\n        return  createElm(vnode)\r\n    }\r\n// 第一次不进行对比，初始化的时候将真实dom渲染成虚拟dom\r\n    const isRealElement = oldVnode.nodeType\r\n    if (isRealElement===1) {\r\n        const oldElm = oldVnode\r\n        const parentElm = oldElm.parentNode  //body\r\n        let el = createElm(vnode)\r\n        parentElm.insertBefore(el, oldVnode.nextSibling) //把新的节点放到原来节点的后面\r\n        oldElm.remove()\r\n        return el\r\n\r\n    }else{\r\n        // 更新时 用老的虚拟节点与新的进行对比，将不同的地方更新真实的dom\r\n\r\n        // 如果tag不同，那么直接替换\r\n        if(oldVnode.tag !== vnode.tag){\r\n         return  oldVnode.el.parentNode.replaceChild(createElm(vnode),oldVnode.el)\r\n        }\r\n        // 如果标签一样 tag都是undefined\r\n        if(!oldVnode.tag){\r\n         if(oldVnode.text !== vnode.text){ \r\n            return oldVnode.el.textContent = vnode.text\r\n         }\r\n        }\r\n        // 标签一样 比对属性 和 儿子  标签一样直接复用\r\n        let el = vnode.el = oldVnode.el\r\n        updateProperties(vnode, oldVnode.data)\r\n\r\n        let oldChildren = oldVnode.children || []\r\n        let newChildren = vnode.children || []\r\n\r\n        // 儿子的比较\r\n        if(oldChildren.length && newChildren.length){    // 3、 老的有儿子，新的也有儿子s\r\n            updateChildren(oldChildren,newChildren,el)\r\n        }else if(oldChildren.length){  // 1、 老的有儿子，新的没有儿子\r\n            el.innerHTML = ''\r\n        }else{  // 2、 老的没儿子，新的有儿子\r\n            for(let i = 0 ; i < newChildren.length;i++){\r\n                let child = newChildren[i]\r\n                el.appendChild(createElm(child))\r\n            }\r\n        }\r\n     \r\n\r\n       \r\n       \r\n    }\r\n}\r\nfunction isSameVnode(oldVnode,newVnode){\r\n    return (oldVnode.tag == newVnode.tag )  && (oldVnode.key == newVnode.key)\r\n}\r\n\r\nfunction makeIndexByKey(children){\r\n    let map = {}\r\n    children.forEach((item,index)=>{\r\n        if(item.key){\r\n            map[item.key] = index\r\n        }\r\n    })\r\n    return map\r\n}\r\nfunction updateChildren(oldChildren,newChildren,parent){\r\n  \r\n    let oldStartIndex = 0\r\n    let oldStartVnode = oldChildren[0]\r\n    let oldEndIndex = oldChildren.length-1\r\n    let oldEndVnode = oldChildren[ oldChildren.length-1]\r\n\r\n    let newStartIndex = 0\r\n    let newStartVnode = newChildren[0]\r\n    let newEndIndex = newChildren.length-1\r\n    let newEndVnode = newChildren[ newChildren.length-1]\r\n    let map = makeIndexByKey(oldChildren) //把旧的key记录下来\r\n    while(oldStartIndex <=oldEndIndex &&  newStartIndex <= newEndIndex){\r\n        if(!oldStartVnode){\r\n            oldStartVnode = oldChildren[++oldStartIndex]\r\n        }else if(!oldEndVnode){\r\n            oldStartVnode = oldChildren[--oldEndIndex]\r\n        }else if(isSameVnode(oldStartVnode,newStartVnode)){  // 如果前面的节点没有改变\r\n            patch(oldStartVnode,newStartVnode)  //更新属性\r\n            oldStartVnode = oldChildren[++oldStartIndex]\r\n            newStartVnode = newChildren[++newStartIndex]\r\n        }else if(isSameVnode(oldEndVnode,newEndVnode)){ //如果后面的节点没有改变\r\n            patch(oldEndVnode,newEndVnode)\r\n            oldEndVnode = oldChildren[--oldEndIndex]\r\n            newEndVnode = newChildren[--newEndIndex]\r\n        }else if(isSameVnode(oldStartVnode,newEndVnode)){  //老的头和新的尾比较\r\n            patch(oldStartVnode,newEndVnode)\r\n            // 当前元素插到当前元素下一个的前面\r\n            parent.insertBefore(oldStartVnode.el,oldEndVnode.el.nextSibling)\r\n            oldStartVnode = oldChildren[++oldStartIndex]\r\n            newEndVnode = newChildren[--newEndIndex]\r\n        }else if(isSameVnode(oldEndVnode,newStartVnode)){ //老的尾和新的头比较\r\n            patch(oldEndVnode,newStartVnode)\r\n            parent.insertBefore(oldEndVnode.el,oldStartVnode.el)\r\n            oldEndVnode = oldChildren[--oldEndIndex]\r\n            newStartVnode = newChildren[++newStartIndex]\r\n        } else{  //都不相等需要暴力比对\r\n            // 如果这个新节点在老节点中没有 那就直接插入\r\n            let moveIndex = map[newStartVnode.key]\r\n            if(moveIndex==undefined){\r\n                parent.insertBefore(createElm(newStartVnode),oldStartVnode.el)\r\n            }else {\r\n                let moveVnode = oldChildren[moveIndex]\r\n                oldChildren[moveIndex] = null\r\n                parent.insertBefore(createElm(moveVnode),oldStartVnode.el) //insertBefore会将元素直接移动走，所以先将这个moveIndex的老元素中设置为null\r\n                patch(moveVnode,newStartVnode)\r\n            }\r\n            newStartVnode = newChildren[++newStartIndex]\r\n\r\n        }\r\n    }\r\n    if(oldStartIndex <= oldEndIndex){  //将剩余的老的节点删除\r\n        for(let i = oldStartIndex;i<= oldEndIndex;i++){\r\n            if(oldChildren[i]){\r\n                parent.removeChild(oldChildren[i].el)\r\n            }\r\n        } \r\n    }\r\n    if(newStartIndex <= newEndIndex){\r\n        for(let i = newStartIndex;i<= newEndIndex;i++){\r\n            parent.appendChild(createElm(newChildren[i]))\r\n            //新元素前面元素与旧元素不一致，那么newChildren 中存在newEndIndex+1，因为是从后往前比对的，\r\n            // 如果newChildren[newEndIndex + 1] == null 说明是从前往后比对的\r\n            let ele = newChildren[newEndIndex + 1] == null ? null : newChildren[newEndIndex + 1] \r\n            parent.insertBefore( createElm(newChildren[i]),ele ) //insertBefore 当第二个值有的时候会把心的值当道第二个值得前面，如果第二个值是null  insertBefore 相当于appendChild\r\n        }\r\n    }\r\n\r\n}\r\n\r\nfunction createComponent(vnode){\r\n    let i = vnode.data  //提取vnode中的data\r\n    if((i=i.hook)&&(i=i.init)){  \r\n        i(vnode)\r\n    }\r\n    if(vnode.componentInstantce){\r\n        return true\r\n    }\r\n}\r\n/**\r\n * 创建真实节点\r\n * @param {*} vnode 虚拟节点\r\n */\r\nfunction createElm(vnode) {\r\n    let { tag, children, key, data, text } = vnode\r\n\r\n    if (typeof tag === 'string') {\r\n\r\n        if(createComponent(vnode)){\r\n            /**\r\n             * 1. 调用mountComponent\r\n             * 2. 创建watcher\r\n             * 3.  vm._update(vm._render())\r\n             * 4. 创建真实节点挂载到vm.$el上\r\n             */\r\n            return vnode.componentInstantce.$el\r\n        }\r\n\r\n        vnode.el = document.createElement(vnode.tag)\r\n        updateProperties(vnode)\r\n        children?.forEach(child => {  //递归创建儿子节0点，将儿子节点当道父节点\r\n            return vnode.el.appendChild(createElm(child))\r\n        })\r\n    } else {\r\n        vnode.el = document.createTextNode(text)\r\n    }\r\n    return vnode.el\r\n}\r\n\r\nfunction updateProperties(vnode,oldProps={}) {\r\n    let newProps = vnode.data || {},\r\n        el = vnode.el\r\n        // 如果新节点上没有 老节点有 移除老节点上的属性\r\n    for(let key in oldProps){\r\n        if(!newProps[key]){\r\n            el.removeAttribute(key)  //移除老节点属性\r\n        }\r\n    }\r\n\r\n    let newStyle = newProps.style\r\n    let oldStyle = oldProps.style\r\n    // 新的中没有 老的中有 则删除老的\r\n    for(let key in oldStyle){\r\n        if(!newStyle[key]){\r\n            el.style[key] = ''\r\n        }\r\n    }\r\n    // 新的有 那就正常加载老的上就行\r\n    for (let key in newProps) {\r\n        if (key === 'style') {\r\n            for (let stylekey in newProps.style) {\r\n                el.style[stylekey] = newProps.style[stylekey]\r\n            }\r\n        }else if(key === 'class'){\r\n            el.className = newProps[key]\r\n        }else{\r\n            el.setAttribute(key,newProps[key])\r\n        }\r\n    }\r\n}","import Watcher from './observe/watcher'\r\nimport { patch } from './vdom/patch'\r\nexport function lifecycleMixin(Vue) {\r\n    // 通过虚拟DOM创建真实的DOm\r\n    Vue.prototype._update = function (vnode) {\r\n        let vm = this\r\n        let prevVnode = vm._vnode\r\n        if (!prevVnode) {\r\n            // 需要用虚拟节点创建真实节点，替换原有的$el\r\n            vm.$el = patch(vm.$el, vnode)\r\n        } else {\r\n            vm.$el = patch(prevVnode, vnode)\r\n        }\r\n        vm._vnode = vnode\r\n    }\r\n}\r\n//初始化组件\r\nexport function mountComponent(vm, el) {\r\n    const options = vm.$options  //render\r\n    vm.$el = el //真实的dom\r\n    callHook(vm, 'beforeMount')\r\n    //_render 通过render方法，渲染出虚拟DOM\r\n    //无论渲染还是更新都会调用此方法\r\n    let updateComponent = () => {\r\n        //返回虚拟dom\r\n        vm._update(vm._render())\r\n    }\r\n    //渲染watcher\r\n    new Watcher(vm, updateComponent, () => {\r\n        callHook(vm, 'updated')\r\n    }, true)\r\n    callHook(vm, 'mounted')\r\n\r\n}\r\n\r\nexport function callHook(vm, hook) {\r\n    const handlers = vm.$options[hook]\r\n    if (handlers) {\r\n        handlers.forEach(hook => {\r\n            hook.call(vm)\r\n        })\r\n    }\r\n}","import { initState } from './state'\r\nimport { compileToFunctoin } from './compile/index.js'\r\nimport { mountComponent, callHook } from './lifecycle.js'\r\nimport { mergeOptions } from './utils/index'\r\nimport { nextTick } from './utils/next-tick'\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        const vm = this \r\n        vm.$options = mergeOptions(vm.constructor.options, options)\r\n        callHook(vm, 'beforeCreate')\r\n        initState(vm)\r\n        callHook(vm, 'created')\r\n        let el = vm.$options.el\r\n        if (el) {\r\n            vm.$mount(el)\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function (el) {\r\n        const vm = this\r\n        el = document.querySelector(el)\r\n\r\n        let template = vm.$options.template\r\n        //如果el存在并且不存在template\r\n        if (!template && el) {\r\n            template = el.outerHTML\r\n        }\r\n        const render = compileToFunctoin(template)()\r\n        vm.$options.render = render\r\n        mountComponent(vm, el)\r\n    }\r\n    Vue.prototype.$nextTick = nextTick\r\n}","import {isReservedTag} from '../utils/index'\r\n\r\n/**\r\n * \r\n * @param {*} tag 标签\r\n * @param {*} data 属性\r\n * @param  {...any} children \r\n */\r\nexport function createElement(vm,tag, data = {}, ...children) {\r\n    let key = data.key\r\n    key ? delete data.key :''\r\n    if(isReservedTag(tag)){\r\n        return vnode(tag, data, key, children,undefined)\r\n    }else{\r\n        let Cons = vm.$options.components[tag]  //全局以及局部的components都在这里，全局的是构造函数，局部的是对象\r\n        \r\n        if(typeof Cons === 'object'){\r\n            Cons = vm.options._base.extent(Cons)\r\n        }\r\n        data.hook = {\r\n            init(vnode){\r\n                let child = vnode.componentInstantce = new Cons({})\r\n                child.$mount()\r\n                /**\r\n                 *  new Cons({})\r\n                 * 1. 执行init\r\n                 * 2. 调用callhock\r\n                 * 3. 初始化state\r\n                 * 4. Cons是Sub的实例，继承Vue\r\n                 */\r\n            }\r\n        }\r\n        return vnode(`vue-compoment-${Cons.cid}-${tag}`,\r\n         data,\r\n         key,\r\n          undefined,\r\n          undefined,\r\n          { Cons,\r\n            children //插槽\r\n        }\r\n          )\r\n    }\r\n}\r\n\r\nexport function createTextNode(text) {\r\n    return vnode(undefined, undefined, undefined, undefined,text)\r\n}\r\n\r\nfunction vnode(tag, data, key, children,text,componentOptions) {\r\n    return {\r\n        tag, \r\n        data, \r\n        key, \r\n        children,\r\n        text,\r\n        componentOptions\r\n    }\r\n}","\r\nimport {createElement,createTextNode} from './vdom/create-element'\r\n\r\nexport function renderMixin(Vue) {\r\n\r\n    // _c 创建元素的虚拟节点\r\n    // _v 创建文本的虚拟节点\r\n    // _s JSON.stringify\r\n\r\n    Vue.prototype._c = function (){\r\n        return createElement(this,...arguments)\r\n    }\r\n    Vue.prototype._v = function (text){\r\n        return createTextNode(text)\r\n    }\r\n    Vue.prototype._s = function (val){\r\n        return val == null ? '' : (typeof val === 'object'?JSON.stringify(val):val)\r\n    }\r\n    Vue.prototype._render = function () {\r\n        let vm = this\r\n        let {render} = vm.$options\r\n        return  render.call(vm)\r\n    }\r\n}","import { mergeOptions } from \"../utils/index.js\"\r\n\r\nexport default function initExtent(Vue) {\r\n    let cid = 0\r\n    let cidarr = []\r\n    Vue.extent = function (extentOptions) {\r\n        let Sub\r\n        if(cidarr.includes(cid)) return Sub\r\n        const Super = this\r\n        Sub = function VueCompoment(options) {\r\n            this._init(options)\r\n\r\n        }\r\n        Sub.cid = cid++\r\n        cidarr.push(Sub.cid)\r\n        Sub.prototype = Object.create(Super.prototype)\r\n        Sub.prototype.constructor = Sub\r\n        // vm.$options = mergeOptions(vm.constructor.options, options) \r\n        /** \r\n         * init中的\r\n         * vm是当前sub的实例\r\n         * vm.constructor.options 是Sub.options Sub.options 是Vue.options 和 extent传进来的\r\n         * 相当于将全局的options 与实例的options储存在一起\r\n         */\r\n        Sub.options = mergeOptions(Super.options,extentOptions)\r\n\r\n        return Sub\r\n    }\r\n}","import {mergeOptions} from '../utils/index.js'\r\nimport initExtent from './extent.js'\r\n \r\nexport function initGlobalAPI (Vue){\r\n    // 整合了所有的全局api  \r\n    Vue.options = {}\r\n\r\n    Vue.mixin = function(mixin){\r\n        this.options = mergeOptions(this.options,mixin)\r\n    }\r\n\r\n    initExtent(Vue)\r\n    Vue.options._base = Vue\r\n    Vue.options.components = {}\r\n    Vue.component = function (id,definition){\r\n        definition.name = definition.name || id\r\n        // new definition().$mount()\r\n        definition = this.options._base.extent(definition)\r\n        // 将全局的components挂载到Vue的options上 ，现在全局的components是一个构造函数\r\n        Vue.options.components[id] = definition\r\n    }\r\n\r\n}","import { initMixin } from './init'\r\nimport {renderMixin} from './render.js'\r\nimport { lifecycleMixin} from './lifecycle'\r\nimport {initGlobalAPI} from './initGlobalAPI/index.js'\r\nimport {stateMixin} from './state.js'\r\nfunction Vue (options){\r\n    this._init(options)\r\n}\r\nstateMixin(Vue)\r\ninitMixin(Vue)\r\nrenderMixin(Vue)\r\nlifecycleMixin(Vue)\r\ninitGlobalAPI(Vue)  //合并api\r\n\r\nexport default Vue"],"names":["isObject","data","proxy","vm","source","key","Object","defineProperty","get","set","val","API_HOOkS","starts","components","parent","child","res","create","forEach","hook","mergeHook","concat","mergeOptions","options","mergefile","hasOwnProperty","isReservedTag","makeMap","str","mapping","list","split","item","tag","oldArrayMethods","Array","prototype","arrayMethods","methods","name","args","result","apply","inserted","ob","__ob__","slice","console","log","dep","notify","observeArray","id","Dep","subs","watcher","push","target","addDep","update","isWatcher","cb","stack","pushTarget","popTarget","pop","length","Observe","enumerable","configurable","value","isArray","__proto__","walk","keys","i","len","defineReactive","observe","childOb","depend","dependArray","newValue","current","callbacks","waiting","flushCallback","timerFunc","Promise","resolve","then","MutationObserver","textNode","document","createTextNode","characterData","textContent","setImmediate","setTimeout","nextTick","queue","has","flushSchedularQueue","run","queueWatcher","Watcher","exportFn","lazy","dirty","user","depsid","Set","deps","getter","reduce","p","c","add","addSub","redult","call","oldValue","initState","opts","$options","props","initData","computed","initComputed","initMethods","watch","initWatch","_data","watchers","_computedWatchers","userDep","defineCpmputed","sharedPropertyDefinition","createComputedGetter","evaluate","method","bind","handlers","handler","createWatcher","exprOrFn","$watch","stateMixin","Vue","immediate","attribute","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","currentParen","root","ELEMENT_TYPE","TEXT_TYPE","createAstElement","tagName","attrs","type","children","start","ele","chars","text","replace","end","paeseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","parse","obj","defaultTagRE","compileToFunctoin","template","render","code","generate","renderFn","Function","el","geneProps","genChildren","map","gen","join","node","tokens","index","lastIndex","exec","JSON","stringify","patch","oldVnode","vnode","createElm","isRealElement","nodeType","oldElm","parentElm","parentNode","insertBefore","nextSibling","remove","replaceChild","updateProperties","oldChildren","newChildren","updateChildren","innerHTML","appendChild","isSameVnode","newVnode","makeIndexByKey","oldStartIndex","oldStartVnode","oldEndIndex","oldEndVnode","newStartIndex","newStartVnode","newEndIndex","newEndVnode","moveIndex","undefined","moveVnode","removeChild","createComponent","init","componentInstantce","$el","createElement","oldProps","newProps","removeAttribute","newStyle","style","oldStyle","stylekey","className","setAttribute","lifecycleMixin","_update","prevVnode","_vnode","mountComponent","callHook","updateComponent","_render","initMixin","_init","constructor","$mount","querySelector","outerHTML","$nextTick","Cons","_base","extent","cid","componentOptions","renderMixin","_c","arguments","_v","_s","initExtent","cidarr","extentOptions","Sub","includes","Super","VueCompoment","initGlobalAPI","mixin","component","definition"],"mappings":"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"}